<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                              "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" >
<html xmlns="http://www.w3.org/TR/1999/REC-html-in-xml" xml:lang="en"
	lang="en">
	<head>
                <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
                <!-- HTML5 -->
                <meta charset="UTF-8"/>
		<style type="text/css">
                    .bodyContainer {
    font-family: Arial, Helvetica, sans-serif;
    text-align: center;
    padding-left: 32px;
    padding-right: 32px;
}

.notebookFor {
    font-size: 18px;
    font-weight: 700;
    text-align: center;
    color: rgb(119, 119, 119);
    margin: 24px 0px 0px;
    padding: 0px;
}

.bookTitle {
    font-size: 32px;
    font-weight: 700;
    text-align: center;
    color: #333333;
    margin-top: 22px;
    padding: 0px;
}

.authors {
    font-size: 13px;
    font-weight: 700;
    text-align: center;
    color: rgb(119, 119, 119);
    margin-top: 22px;
    margin-bottom: 24px; 
    padding: 0px;
}

.citation {
    font-size: 16px;
    font-weight: 500;
    text-align: center;
    color: #333333;
    margin-top: 22px;
    margin-bottom: 24px;
    padding: 0px;
}

.sectionHeading {
    font-size: 24px;
    font-weight: 700;
    text-align: left;
    color: #333333;
    margin-top: 24px;
    padding: 0px;
}

.noteHeading {
    font-size: 18px;
    font-weight: 700;
    text-align: left;
    color: #333333;
    margin-top: 20px;
    padding: 0px;
}

.noteText {
    font-size: 18px;
    font-weight: 500;
    text-align: left;
    color: #333333;
    margin: 2px 0px 0px;
    padding: 0px;
}

.highlight_blue {
    color: rgb(178, 205, 251);
}

.highlight_orange {
    color: #ffd7ae;
}

.highlight_pink {
    color: rgb(255, 191, 206);
}

.highlight_yellow {
    color: rgb(247, 206, 0);
}

.notebookGraphic {
    margin-top: 10px;
    text-align: left;
}

.notebookGraphic img {
    -o-box-shadow:      0px 0px 5px #888;
    -icab-box-shadow:   0px 0px 5px #888;
    -khtml-box-shadow:  0px 0px 5px #888;
    -moz-box-shadow:    0px 0px 5px #888;
    -webkit-box-shadow: 0px 0px 5px #888;
    box-shadow:         0px 0px 5px #888; 
    max-width: 100%;
    height: auto;
}

hr {
    border: 0px none;
    height: 1px;
    background: none repeat scroll 0% 0% rgb(221, 221, 221);
}

		</style>
		<script type="text/javascript">
		    
		</script>
		<title></title>
	</head>
    <body>
        <div class="bodyContainer">
            <div class="notebookFor">
Notebook for
</div>
<div class="bookTitle">
PoC or GTFO
</div>
<div class="authors">
Laphroaig, Manul
</div>
<div class="citation">
Citation (Chicago Style): Laphroaig, Manul. <i>PoC or GTFO</i>. No Starch Press, 2017. Kindle edition.
</div>
<hr />

            <div class="sectionHeading">
Chapter 5: Address to the Inhabitants of Earth
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:5 A Flash PDF Polyglot >  Location 3780
</div>
<div class="noteText">
Windows 8 32 Bit:– IE 11: PDF parsed, Flash not parsed– Chrome: PDF parsed, Flash not parsed– Firefox: PDF not parsed, Flash parsed– Adobe Reader 11.0.07: PDF parsed• Windows 7 64 Bit:– IE 11: PDF parsed, Flash not parsed– Chrome: PDF parsed, Flash parsed– Firefox: PDF not parsed, Flash parsed– Opera: PDF parsed, Flash parsed– Adobe Reader 11.0.07: PDF parsed• Windows 7 Enterprise 32 Bit:– IE 11: PDF parsed, Flash parsed– Chrome: PDF parsed, Flash not parsed– Firefox: PDF not parsed, Flash parsed– Adobe Reader 11.0.07: PDF parsed
</div>
<div class="noteHeading">
Note - 5:5 A Flash PDF Polyglot >  Location 3794
</div>
<div class="noteText">
Strange that most tested systems are 32-bit but 64-bit systems are probably more relevant nowadays (and even more by the day).
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3814
</div>
<div class="noteText">
Traditionally, Ring 0 is used by the kernel while Ring 3 is used by user-level applications. Modern microkernels can utilize Rings 1 and 2 to offload drivers to a less privileged ring still granting I/ O privileges.
</div>
<div class="noteHeading">
Note - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3815
</div>
<div class="noteText">
Great tidbit and very well done for the author to include it here.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3836
</div>
<div class="noteText">
and the return EIP on the stack before handling control to the interrupt handler.
</div>
<div class="noteHeading">
Note - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3836
</div>
<div class="noteText">
Typo: "before handling control to."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3837
</div>
<div class="noteText">
Trap Gates: Trap gates are similar to interrupt gates, but interrupts are not masked upon entry.
</div>
<div class="noteHeading">
Note - 5:6 This Multiprocessing OS is a Boot Sector >  Location 3838
</div>
<div class="noteText">
Why use different confusing terminology for the same thing? "disabled" earlier and "masked" here.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:7 A Breakout Board for Mini-PCIe >  Location 3976
</div>
<div class="noteText">
The PCI SIG actually did a pretty darn good job with PCIe.
</div>
<div class="noteHeading">
Note - 5:7 A Breakout Board for Mini-PCIe >  Location 3977
</div>
<div class="noteText">
Should probably explain SIG (I think Special Interest Group that's responsible for a thing) here instead of forcing the reader to look it up.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:7 A Breakout Board for Mini-PCIe >  Location 3985
</div>
<div class="noteText">
We’ve got a PCIe 3.0 x16 device— sixteen TX pairs and sixteen RX pairs
</div>
<div class="noteHeading">
Note - 5:7 A Breakout Board for Mini-PCIe >  Location 3986
</div>
<div class="noteText">
Not really sure, but I'd guest it's (16 RX/TX pairs) and not (16 RX pairs + 16 TX pairs).
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:8 Prototyping a generic x86 backdoor in Bochs >  Location 4088
</div>
<div class="noteText">
Note that CTR mode is malleable. If this were a production system, I would include a MAC and store the MAC result in an additional register pair.
</div>
<div class="noteHeading">
Note - 5:8 Prototyping a generic x86 backdoor in Bochs >  Location 4089
</div>
<div class="noteText">
Should probably clarify what you mean here by "malleable". I'd guess authentication.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:8 Prototyping a generic x86 backdoor in Bochs >  Location 4147
</div>
<div class="noteText">
For sake of simplicity,
</div>
<div class="noteHeading">
Note - 5:8 Prototyping a generic x86 backdoor in Bochs >  Location 4147
</div>
<div class="noteText">
Typo: "For sake of simplicity."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4288
</div>
<div class="noteText">
Cisco UCS
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4288
</div>
<div class="noteText">
Would be nice to know what "UCS" here stands for.
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4288
</div>
<div class="noteText">
Would be nice to explain it in a couple of words.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4288
</div>
<div class="noteText">
KVM
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4294
</div>
<div class="noteText">
Would be nice to explain this in a couple of words.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4294
</div>
<div class="noteText">
BMC
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4296
</div>
<div class="noteText">
Cisco blade
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4296
</div>
<div class="noteText">
Would be nice to explain it in a couple of words.
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4300
</div>
<div class="noteText">
Would be nice to explain this in a couple of words.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4300
</div>
<div class="noteText">
CVSS
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4369
</div>
<div class="noteText">
This applies to many protocols which two distinct roles,
</div>
<div class="noteHeading">
Note - 5:9 Your Cisco blade is booting PoC∥GTFO. >  Location 4369
</div>
<div class="noteText">
Typo: "which."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:10 I am my own NOP Sled. >  Location 4419
</div>
<div class="noteText">
Combining those two instruction
</div>
<div class="noteHeading">
Note - 5:10 I am my own NOP Sled. >  Location 4419
</div>
<div class="noteText">
Typo: "combining those two instruction."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 5:12 Sexy collision PoCs >  Location 4602
</div>
<div class="noteText">
Aumasson et al. 2526
</div>
<div class="noteHeading">
Note - 5:12 Sexy collision PoCs >  Location 4603
</div>
<div class="noteText">
2 referenced footnotes appear in a confusing way here.
</div>
<div class="sectionHeading">
Chapter 6: Old Timey Exploitation
</div>
<div class="noteHeading">
Note - 6:2 On Giving Thanks >  Location 4792
</div>
<div class="noteText">
Should probably expand the acronym here, at least, between parens.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:2 On Giving Thanks >  Location 4792
</div>
<div class="noteText">
FUD
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:6 Detecting MIPS Emulation >  Location 5390
</div>
<div class="noteText">
we’ll intentionally run code which has a pending overwrite in the data cache to determine whether the instruction and data caches are synchronized with one other,
</div>
<div class="noteHeading">
Note - 6:6 Detecting MIPS Emulation >  Location 5391
</div>
<div class="noteText">
Typo: "with one other."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:6 Detecting MIPS Emulation >  Location 5418
</div>
<div class="noteText">
root@ qemu :~# cat/ proc/ cpuinfo
</div>
<div class="noteHeading">
Note - 6:6 Detecting MIPS Emulation >  Location 5418
</div>
<div class="noteText">
Incorrect command: should be "cat /proc/cpuinfo" and not "cat/ proc/ cpuinfo".
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:6 Detecting MIPS Emulation >  Location 5468
</div>
<div class="noteText">
36 char ret1 [CODE_SIZE] = " \x08\ x00\ xe0\ x03" // jr $ ra 38 " \x01\ x00\ x02\ x24"; // li $ v0,1
</div>
<div class="noteHeading">
Note - 6:6 Detecting MIPS Emulation >  Location 5469
</div>
<div class="noteText">
Should probably use `uint8_t` (or its equivalent `unsigned char`) instead of `char` and avoid using strings.

This will produce the same end results and avoid unnecessary escaping and possible complaints of compilers due to missing space for a null-terminator.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:6 Detecting MIPS Emulation >  Location 5490
</div>
<div class="noteText">
It’s worth noting that in theory, the second block of code (ret2) could be executed when running on real MIPS hardware if the kernel flushed the cache behind your back in between the time that ret2 is copied into buf and the time that you actually call into buf. However, this would be a very unlucky edge case which I have yet to encounter in practice, provided the time between the second memcpy to buf and the call to buf is minimized. ret1 is never executed in Qemu.
</div>
<div class="noteHeading">
Note - 6:6 Detecting MIPS Emulation >  Location 5495
</div>
<div class="noteText">
This point is important and should be taken into account. For example, the exploit code should be idempotent run multiple times to maximize the probability of its running.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:7 More Cryptographic Coloring Books >  Location 5504
</div>
<div class="noteText">
This reverseciphertext encrypts back to the original plaintext because block encryption and decryption operations can be safely exchanged.
</div>
<div class="noteHeading">
Note - 6:7 More Cryptographic Coloring Books >  Location 5505
</div>
<div class="noteText">
Typo: "reverseciphertext."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:7 More Cryptographic Coloring Books >  Location 5549
</div>
<div class="noteText">
1 $ python ElectronicColoringBook.py combined.png -p4 -03 -c255 -x 600.345
</div>
<div class="noteHeading">
Note - 6:7 More Cryptographic Coloring Books >  Location 5550
</div>
<div class="noteText">
What's with the the cryptic single-letter options?

Would be immensely helpful to use full-word options that are self-documenting.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:7 More Cryptographic Coloring Books >  Location 5578
</div>
<div class="noteText">
Exploring other chaining modes
</div>
<div class="noteHeading">
Note - 6:7 More Cryptographic Coloring Books >  Location 5579
</div>
<div class="noteText">
Should probably compare with AE (e.g., AES-GCM).  And even better, an AE PoC.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5738
</div>
<div class="noteText">
msg. txt into msg. elf
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5738
</div>
<div class="noteText">
The issue of having accidental space after periods seems pervasive in this section and maybe the entire book.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5802
</div>
<div class="noteText">
Always use syscall wrappers in binary hardening code, and stay away from glibc.
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5802
</div>
<div class="noteText">
This can be inferred by the assembly code in `_ptrace` and other `_`-prefixed syscalls but this should be mentioned explicitly (e.g: `_write`, `_exit`, and `_getpid` are custom wrappers we wrote).
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5827
</div>
<div class="noteText">
20 /* Simply call _prctl( PR_SET_DUMPABLE, 0 , 0 , 0 , 0) * from your code, ideally from a glibc constructor. 22 */ 24 void anti_debug_dump( void) __attribute__ (( constructor));
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5829
</div>
<div class="noteText">
Not really sure but isn't it easier to remove constructors from a binary, relative to non-constructors?
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5855
</div>
<div class="noteText">
40 __asm__ (" int3\ n" "nop"); 42 if (trap_count = = 0) bail_out(); // debugger caught the trap, bail out! 44 trap_count = 0;
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5857
</div>
<div class="noteText">
No braces used and there doesn't seem to be indentation to see clearly, when scanning the code, that only a single line is executed.

This is more a matter of style, but always using braces with conditionals can obviate the need for long debugging nights and critical bugs that only happen under certain conditions.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5862
</div>
<div class="noteText">
/proc/-self/ maps
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5863
</div>
<div class="noteText">
Typo: "-self."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:9 Davinci Seal >  Location 5883
</div>
<div class="noteText">
Figure 6.26: Davinci Code Watermarking
</div>
<div class="noteHeading">
Note - 6:9 Davinci Seal >  Location 5884
</div>
<div class="noteText">
Why the unnecessary `void *`/`uint8_t *` casts, especially when `void *` and no pointer arithmetic used?

I didn't compile the code but I think even the strictest diagnostics pass without warnings (maybe except for the function which may produce an incompatible pointer).
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:10 Observable Metrics >  Location 5998
</div>
<div class="noteText">
It’s their only method for keeping up with worldwide evolution in culture.
</div>
<div class="noteHeading">
Note - 6:10 Observable Metrics >  Location 5998
</div>
<div class="noteText">
Do you mean "evolution and culture?"
</div>
<div class="noteHeading">
Note - 6:10 Observable Metrics >  Location 6061
</div>
<div class="noteText">
Would be nice here to at least expand the acronym.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 6:10 Observable Metrics >  Location 6061
</div>
<div class="noteText">
SCIF
</div>
<div class="sectionHeading">
Chapter 7: PoC∥GTFO, Calisthenics and Orthodontia
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:1 With what shall we commune this evening? >  Location 6104
</div>
<div class="noteText">
PoC ∥ GTFO 7: 11 is the latest from Ben Nagy, a peppy little parody of Hacker News and New Media Web 2.0 Hipster Fashion Accessorized Cybercrime in the style of Gilbert and Sullivan. Sing along, if you like!
</div>
<div class="noteHeading">
Note - 7:1 With what shall we commune this evening? >  Location 6106
</div>
<div class="noteText">
There doesn't seem to be a 7:10 section and this should probably be explained.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:4 The Lysenko Sermon >  Location 6260
</div>
<div class="noteText">
to protect the impressionable youth who could otherwise be mislead by complicated arguments;
</div>
<div class="noteHeading">
Note - 7:4 The Lysenko Sermon >  Location 6260
</div>
<div class="noteText">
Should probably be "be misled" here instead of "be mislead."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:5 When Scapy is too high-level >  Location 6333
</div>
<div class="noteText">
The destination port is implicitly used to specify what the application layer will be: HTTP (80), HTTPS (443), SSH (22), SMTP (25), and so on.
</div>
<div class="noteHeading">
Note - 7:5 When Scapy is too high-level >  Location 6334
</div>
<div class="noteText">
I don't think that this is always the case. For example, a website may serve traffic on the `8080` port over either HTTP or HTTPS.

And one reason such ports are used is that they require less privileges.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:6 Abusing file formats >  Location 6532
</div>
<div class="noteText">
Obviously, there is no room for abusing signatures as long as the content and the offset of the signatures are strictly enforced.
</div>
<div class="noteHeading">
Note - 7:6 Abusing file formats >  Location 6532
</div>
<div class="noteText">
Seems too strong of a statement. For example, if one strict signature is a prefix of another strict signature, there could still be room for abuse.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:6 Abusing file formats >  Location 6608
</div>
<div class="noteText">
PDF/ ZIP/ BPG/-HTML
</div>
<div class="noteHeading">
Note - 7:6 Abusing file formats >  Location 6608
</div>
<div class="noteText">
Do you mean here "HTML" and not "-HTML"?
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:6 Abusing file formats >  Location 6642
</div>
<div class="noteText">
A PDF directly stores JPG image
</div>
<div class="noteHeading">
Note - 7:6 Abusing file formats >  Location 6642
</div>
<div class="noteText">
You probably mean here either "a JPG image" or "JPG images."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:6 Abusing file formats >  Location 6844
</div>
<div class="noteText">
or a installer
</div>
<div class="noteHeading">
Note - 7:6 Abusing file formats >  Location 6844
</div>
<div class="noteText">
Typo: "a installer."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:7 AES-NI Backdoors >  Location 6895
</div>
<div class="noteText">
and [sic]
</div>
<div class="noteHeading">
Note - 7:7 AES-NI Backdoors >  Location 6895
</div>
<div class="noteText">
What does "[sic]" mean?
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:7 AES-NI Backdoors >  Location 6908
</div>
<div class="noteText">
it was in, fact,
</div>
<div class="noteHeading">
Note - 7:7 AES-NI Backdoors >  Location 6908
</div>
<div class="noteText">
Typo: "in, fact."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:7 AES-NI Backdoors >  Location 6964
</div>
<div class="noteText">
checking the platform as whole
</div>
<div class="noteHeading">
Note - 7:7 AES-NI Backdoors >  Location 6964
</div>
<div class="noteText">
You probably mean here "as a whole."
</div>
<div class="noteHeading">
Note - 7:7 AES-NI Backdoors >  Location 6974
</div>
<div class="noteText">
"MSR" doesn't seem to be explained anywhere and explaining it would be very useful and save the readers the time to look it up.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:7 AES-NI Backdoors >  Location 6974
</div>
<div class="noteText">
MSR
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:7 AES-NI Backdoors >  Location 6975
</div>
<div class="noteText">
#include < linux/ module.h > 2 #include < linux/ device.h > #include < linux/ highmem.h > 4 #include < linux/ kallsyms.h > #include < linux/ tty.h > 6 #include < linux/ ptrace.h > #include < linux/ version.h > 8 #include < linux/ slab.h > #include < asm/ io.h > 10 #include "include/ rop.h" #include < linux/ smp.h > 12 #define_GNU_SOURCE
</div>
<div class="noteHeading">
Note - 7:7 AES-NI Backdoors >  Location 6980
</div>
<div class="noteText">
"#define _GNU_SOURCE" should probably be first thing in the file so that headers handle it correctly and, if subsequent macros include headers, they don't produce conflicting behavior.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:8 Innovations with Linux core files. >  Location 7063
</div>
<div class="noteText">
echo '| ecfs -i -e %e -p %p -o cores /% e .% p' > / proc / sys / kernel / core_pattern
</div>
<div class="noteHeading">
Note - 7:8 Innovations with Linux core files. >  Location 7063
</div>
<div class="noteText">
Is the space in "% e" intentional?
</div>
<div class="noteHeading">
Note - 7:8 Innovations with Linux core files. >  Location 7359
</div>
<div class="noteText">
Do you mean here "PLT/GOT?"
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:8 Innovations with Linux core files. >  Location 7359
</div>
<div class="noteText">
PLT/-GOT
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:8 Innovations with Linux core files. >  Location 7368
</div>
<div class="noteText">
strdup(& desc;-> shstrtab[ desc-> shdr[ i]. sh_name]);
</div>
<div class="noteHeading">
Note - 7:8 Innovations with Linux core files. >  Location 7369
</div>
<div class="noteText">
There seems to be a mistake with ";" in the middle of arguments.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:11 Cyber Criminal’s Song >  Location 7508
</div>
<div class="noteText">
(But to stay close the metal
</div>
<div class="noteHeading">
Note - 7:11 Cyber Criminal’s Song >  Location 7508
</div>
<div class="noteText">
Do you mean here "close to the metal?"
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 7:11 Cyber Criminal’s Song >  Location 7509
</div>
<div class="noteText">
WE PREFER TO ROLL ON NODE
</div>
<div class="noteHeading">
Note - 7:11 Cyber Criminal’s Song >  Location 7509
</div>
<div class="noteText">
Do you mean here "roll with?"
</div>
<div class="sectionHeading">
Chapter 8: Exploits Sit Lonely on the Shelf
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8072
</div>
<div class="noteText">
Should probably be here "Javascript-based" instead.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8072
</div>
<div class="noteText">
Javascriptbased
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8074
</div>
<div class="noteText">
using HTML5 CANVAS-based on a technique first discussed at EUSecWest 2012
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8074
</div>
<div class="noteText">
Wording seems off.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8202
</div>
<div class="noteText">
http-equiv =" X--UA--Compatible"
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8202
</div>
<div class="noteText">
Seems to be using double-dashes here instead of single ones.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8228
</div>
<div class="noteText">
of the these two components
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8229
</div>
<div class="noteText">
Typo "the these two."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8275
</div>
<div class="noteText">
1 typedef struct _JFIFHeader { BYTE SOI[ 2]; // FF D8 3 BYTE APP0[ 2]; // FF E0 BYTE Length[ 2]; // Length of APP0 field 5 // excluding APP0 marker BYTE Identifier[ 5];// "JFIF\ 0" 7 BYTE Version[ 2]; // Major, Minor BYTE Units; // 0 = no units 9 // 1 = pixels per inch // 2 = pixels per cm 11 BYTE Xdensity[ 2]; // Horiz Pixel Density BYTE Ydensity[ 2]; // Vert Pixel Density 13 BYTE XThumbnail; // Thumb Width (if any) BYTE YThumbnail; // Thumb Height (if any) 15 } JFIFHEAD;
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8287
</div>
<div class="noteText">
A reader could accidentally use this and discover it doesn't work due to its not being packed, aligned, or unexpected endianness.

Either the struct should be packed with endianness comments or a note should mention these considerations.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8301
</div>
<div class="noteText">
1 $ ./ html_in_jpg_ie.pl decoder_cve_2014_0282. html \ kevin_encoded.jpg kevin_polyglot
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8303
</div>
<div class="noteText">
Since a break escape "\" is used here, it can be much more readable (especially in a book) if each argument is on its own line.

This, naturally, applies to the whole book.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8312
</div>
<div class="noteText">
which can affect the execution of the decoder Javascript.
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8312
</div>
<div class="noteText">
Do you mean here "the decoded Javascript?"
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8326
</div>
<div class="noteText">
Since the language type is set to text/-undefined,
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8326
</div>
<div class="noteText">
Do you mean here "text/undefined?"

The book seems to have multiple typos where "/-" is used instead of "/."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8408
</div>
<div class="noteText">
HTTP Content-Type response header
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8409
</div>
<div class="noteText">
Probably missing a period (".") here at the end of the sentence.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8415
</div>
<div class="noteText">
Combining Content Sniffing tricks with these delivery approaches open up several creative attack delivery avenues.
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8416
</div>
<div class="noteText">
"opens up" is probably more appropriate here.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:7 Stegosploit >  Location 8422
</div>
<div class="noteText">
Figure 8.21: Content Sniffing Matrix
</div>
<div class="noteHeading">
Note - 8:7 Stegosploit >  Location 8423
</div>
<div class="noteText">
"(Yes)" used in figure should be explained.

This maybe a note for the figure's book, but at least browsers' versions should be mentioned.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:8 On Error Resume Next >  Location 8464
</div>
<div class="noteText">
struct sigaction sa; 2 memset (& sa, 0, sizeof( sigaction));
</div>
<div class="noteHeading">
Note - 8:8 On Error Resume Next >  Location 8465
</div>
<div class="noteText">
`sizeof(sigaction)` implies that there's a `typedef` for `struct sigaction`. Is this indeed the case?

Or do you mean here to use `sizeof(sa)`. Which would actually work correctly (at least C99+) since the value is known at compile-time.

On second thought, this seems to get the size of the `sigaction` function/pointer which is almost certainly wrong.
</div>
<div class="noteHeading">
Note - 8:8 On Error Resume Next >  Location 8471
</div>
<div class="noteText">
What's with the obfuscated short name?
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:8 On Error Resume Next >  Location 8471
</div>
<div class="noteText">
liboern.so
</div>
<div class="noteHeading">
Note - 8:10 Backdoors up my Sleeve >  Location 8498
</div>
<div class="noteText">
Do you mean here "nothing-up-my-sleeve?"
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:10 Backdoors up my Sleeve >  Location 8498
</div>
<div class="noteText">
“nothing-upmy-sleeve”
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:10 Backdoors up my Sleeve >  Location 8561
</div>
<div class="noteText">
Hash functions can thus “sanitize” similar NUMS by produce completely different constants:
</div>
<div class="noteHeading">
Note - 8:10 Backdoors up my Sleeve >  Location 8561
</div>
<div class="noteText">
Do you mean here "by producing?'
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:10 Backdoors up my Sleeve >  Location 8584
</div>
<div class="noteText">
Various degrees of exclusive exploitability (“ NOBUS”) may be achieved,
</div>
<div class="noteHeading">
Note - 8:10 Backdoors up my Sleeve >  Location 8585
</div>
<div class="noteText">
"NOBUS" should be explained here as it's easy to do so by just expanding the acronym and many readers may not infer its meaning correctly here.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:11 Naughty Signals >  Location 8640
</div>
<div class="noteText">
or employees of that that government anywhere
</div>
<div class="noteHeading">
Note - 8:11 Naughty Signals >  Location 8640
</div>
<div class="noteText">
Typo: "that that."
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:11 Naughty Signals >  Location 8650
</div>
<div class="noteText">
mkfifo ~/ desktop
</div>
<div class="noteHeading">
Note - 8:11 Naughty Signals >  Location 8650
</div>
<div class="noteText">
You seem to be creating a FIFO using a confusing name that can be confused with the usual "~/Desktop" directory.
</div>
<div class="noteHeading">
Note - 8:11 Naughty Signals >  Location 8673
</div>
<div class="noteText">
"compatible" seems to be misspelled here.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - 8:11 Naughty Signals >  Location 8673
</div>
<div class="noteText">
8:
</div>
<div class="sectionHeading">
Footnotes
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - Chapter 5: Address to the Inhabitants of Earth >  Location 9635
</div>
<div class="noteText">
for SWF-file-format-spec.PDF.
</div>
<div class="noteHeading">
Note - Chapter 5: Address to the Inhabitants of Earth >  Location 9636
</div>
<div class="noteText">
This maybe a bit pedantic but does filename really end with `.PDF` and not `.pdf`.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - Chapter 5: Address to the Inhabitants of Earth >  Location 9636
</div>
<div class="noteText">
6PoC ∥ GTFO 4: 3 on page 208.
</div>
<div class="noteHeading">
Note - Chapter 5: Address to the Inhabitants of Earth >  Location 9637
</div>
<div class="noteText">
The footnote (no. 6 here) is included in the footnote text which is atypical in Kindle books.

This issue is probably in other places in the book too.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - Chapter 6: Old Timey Exploitation >  Location 9682
</div>
<div class="noteText">
www.ctyme.com/ intr/ cat-003. htm
</div>
<div class="noteHeading">
Note - Chapter 6: Old Timey Exploitation >  Location 9682
</div>
<div class="noteText">
Why do URLs use HTTP instead of HTTPS?
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - Chapter 8: Exploits Sit Lonely on the Shelf >  Location 9798
</div>
<div class="noteText">
github.com/ dbittman/ seakernel/ unzippocorgtfo08. pdf seakernel-exploit.zip
</div>
<div class="noteHeading">
Note - Chapter 8: Exploits Sit Lonely on the Shelf >  Location 9798
</div>
<div class="noteText">
The URL seems to be wrong and confused with an unzip command.
</div>
<div class="noteHeading">
Highlight (<span class="highlight_yellow">yellow</span>) - Chapter 8: Exploits Sit Lonely on the Shelf >  Location 9812
</div>
<div class="noteText">
www.coresecurity.com/ corelabs-research/ publications/-html5-heap-sprays-pwn-all-things
</div>
<div class="noteHeading">
Note - Chapter 8: Exploits Sit Lonely on the Shelf >  Location 9812
</div>
<div class="noteText">
The URL here seems off: the last part of the path starts with "-."
</div>

        </div>
    </body>
</html>
